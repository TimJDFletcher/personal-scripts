#!/usr/bin/env python

# Python script to process the antipublic and exploit.in dumps
# for LateRoom password hashing
# Hints from:
# http://stackoverflow.com/questions/32038881/python-get-base64-encoded-md5-hash-of-an-image-object

import gzip
import sys
import hashlib
import csv

with gzip.open(sys.argv[1],'r') as fin:
    for line in fin:
        line = line.rstrip()
        data = line.split(':')
        hash = hashlib.md5(data[-1])
        digest = hash.digest().encode('base64')
        writer = csv.writer(sys.stdout,delimiter=',',quotechar='"')
        writer.writerow([data[0], digest.rstrip('\r\n'),])
